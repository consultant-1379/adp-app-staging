# Code base structure in Product CI

**Table of contents:**
<!-- START doctoc
...
END doctoc -->

## Main repository for Product CI

* Git repository for the Product CI code: <https://gerrit.ericsson.se/#/q/project:EEA/adp-app-staging>

## Structure

* The jobDSL groovy scripts which contains the Jenkins projects (jobs) and their referenced jenkinsfiles are stored in SCM in this directory structure:

```
(root)
+-jobs
|   +-dslTest
|       +-DslTest.groovy
|       +-TestJobManagement.groovy
|   +-eea_adp_staging
|       +-eea_adp_staging_adp_prepare_baseline.groovy
|       +-eea_adp_staging_adp_nx1_loop.groovy
|   +-eea_application_staging
|       +-eea_application_staging_prepare_baseline.groovy
|       +-eea_application_staging_nx1.groovy
|       +-eea_application_staging_batch.groovy
|       +-eea_application_staging_publish_baseline.groovy
|   +-eea_adp_batch_loop
|       +-eea_adp_batch_loop.groovy
|   +-eea_app_baseline_manual_flow
|       +-eea_app_baseline_manual_flow_precodereview.groovy
|       +-eea_app_baseline_manual_flow_codereview_ok.groovy
+pipelines
|   +-eea_adp_staging
|       +-eea_adp_staging_adp_nx1_loop.Jenkinsfile
|       +-eea_adp_staging_adp_prepare_baseline.Jenkinsfile
|   +-eea_application_staging
|       +-eea_application_staging_prepare_baseline.Jenkinsfile
|       +-eea_application_staging_nx1.Jenkinsfile
|       +-eea_application_staging_batch.Jenkinsfile
|       +-eea_application_staging_publish_baseline.Jenkinsfile
|   +-eea_adp_batch_loop
|       +-eea_adp_batch_loop.Jenkinsfile
|   +-eea_app_baseline_manual_flow
|       +-eea_app_baseline_manual_flow_precodereview.Jenkinsfile
|       +-eea_app_baseline_manual_flow_codereview_ok.Jenkinsfile
+-technicals  #technicals jobs (validations and seeds) groovy , jenkinsfile and script files
|       +-shellscripts                      #scripts
|       +-functional_test                   #ci code functional test loop and tests
|       +-hooks                             #code analysis scripts
|       +-hooks_static                      #static code analysis scripts
|       +-pythonscripts                     #python scripts
+-tests
|       +-  test job groovy files
|       +-  test job Jenkinsfile files
+-eric-eea-ci-code-helm-chart  #helm chart of the ci code
+-bob       # technical folder for using bob
+-ansible # Ansible playbooks used creating vi environment
+-code-qa # pmd rulesets
+-spinnaker_pipelines # JSON files of spinnaker pipelines
```

## Mandatory pipeline elements

* A seed job in technicals/ directory with \<pipeline name\>_seed.groovy naming convention.
* jobDSL groovy file for the Jenkins jobs to be generated by the seed job
* jenkinsfile with the pipeline code at pipelines/\<pipeline name\> directory with \<pipeline name\>.Jenkinsfile naming convention
* JobDSL code should contain logic to trigger pipelines written in the Jenkinsfiles!
* This structure is validated with the following job:   verify-hook-job

## Additional repositories in Product CI

* Repository for integration (umbrella) helm charts: <https://gerrit.ericsson.se/#/admin/projects/EEA/cnint>
* Repository for CI shared libraries (can be used by other pipelines as well, not just Product CI): <https://gerrit.ericsson.se/#/admin/projects/EEA/ci_shared_libraries>
