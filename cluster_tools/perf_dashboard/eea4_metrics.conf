input {
  stdin {}
}

filter {
  csv {
    separator => ","
    autodetect_column_names => true
    convert => {
      "kube_pod_container_status_restarts_total" => "integer"
      "kube_pod_container_resource_limits_memory_bytes" => "integer"
      "avg.kube_pod_container_resource_limits_memory_bytes" => "float"
      "max.kube_pod_container_resource_limits_memory_bytes" => "float"
      "kube_pod_container_resource_requests_memory_bytes" => "integer"
      "avg.kube_pod_container_resource_requests_memory_bytes" => "float"
      "max.kube_pod_container_resource_requests_memory_bytes" => "float"
      "kube_pod_container_resource_limits_cpu_cores" => "float"
      "avg.kube_pod_container_resource_limits_cpu_cores" => "float"
      "max.kube_pod_container_resource_limits_cpu_cores" => "float"
      "kube_pod_container_resource_requests_cpu_cores" => "float"
      "avg.kube_pod_container_resource_requests_cpu_cores" => "float"
      "max.kube_pod_container_resource_requests_cpu_cores" => "float"
      "container_cpu_cfs_periods_total" => "float"
      "container_cpu_cfs_throttled_periods_total" => "float"
      "container_cpu_cfs_throttled_seconds_total" => "float"
      "avg.container_cpu_cfs_throttled_seconds_total" => "float"
      "max.container_cpu_cfs_throttled_seconds_total" => "float"
      "container_cpu_system_seconds_total" => "float"
      "container_cpu_usage_seconds_total" => "float"
      "avg.container_cpu_usage_seconds_total" => "float"
      "max.container_cpu_usage_seconds_total" => "float"
      "container_cpu_user_seconds_total" => "float"
      "container_memory_cache" => "integer"
      "avg.container_memory_cache" => "float"
      "max.container_memory_cache" => "float"
      "container_memory_failcnt" => "integer"
      "container_memory_mapped_file" => "integer"
      "container_memory_failures_total" => "integer"
      "container_memory_max_usage_bytes" => "integer"
      "container_memory_rss" => "integer"
      "container_memory_swap" => "integer"
      "container_memory_usage_bytes" => "integer"
      "container_memory_working_set_bytes" => "integer"
      "avg.container_memory_working_set_bytes" => "float"
      "max.container_memory_working_set_bytes" => "float"
      "container_network_receive_bytes_total" => "float"
      "container_network_receive_errors_total" => "float"
      "container_network_receive_packets_dropped_total" => "float"
      "container_network_receive_packets_total" => "float"
      "container_network_transmit_bytes_total" => "float"
      "container_network_transmit_errors_total" => "float"
      "container_network_transmit_packets_dropped_total" => "float"
      "container_network_transmit_packets_total" => "float"
      "container_fs_inodes_free" => "integer"
      "container_fs_usage_bytes" => "integer"
      "container_fs_limit_bytes" => "integer"
      "container_fs_io_current" => "integer"
      "container_fs_inodes_total" => "float"
      "container_fs_io_time_seconds_total" => "float"
      "container_fs_io_time_weighted_seconds_total" => "float"
      "container_fs_read_seconds_total" => "float"
      "container_fs_reads_bytes_total" => "float"
      "container_fs_reads_merged_total" => "float"
      "container_fs_reads_total" => "float"
      "container_fs_sector_reads_total" => "float"
      "container_fs_sector_writes_total" => "float"
      "container_fs_write_seconds_total" => "float"
      "container_fs_writes_bytes_total" => "float"
      "container_fs_writes_merged_total" => "float"
      "container_fs_writes_total" => "float"
      "java_lang_Memory_NonHeapMemoryUsage_used" => "integer"
      "java_lang_Memory_HeapMemoryUsage_used" => "integer"
      "java_lang_Memory_HeapMemoryUsage_max" => "integer"
      "java_lang_Memory_HeapMemoryUsage_init" => "integer"
      "high_loaded_cpu" => "integer"
      "cpu_number" => "integer"
      "avg.cpu_number" => "float"
      "sum.cpu_number" => "float"
      "max.cpu_number" => "float"
      "user" => "float"
      "avg.user" => "float"
      "sum.user" => "float"
      "max.user" => "float"
      "system" => "float"
      "avg.system" => "float"
      "sum.system" => "float"
      "max.system" => "float"
      "iowait" => "float"
      "avg.iowait" => "float"
      "sum.iowait" => "float"
      "max.iowait" => "float"
      "idle" => "float"
      "avg.idle" => "float"
      "sum.idle" => "float"
      "max.idle" => "float"
      "used" => "float"
      "avg.used" => "float"
      "sum.used" => "float"
      "max.used" => "float"
      "nice" => "float"
      "avg.nice" => "float"
      "sum.nice" => "float"
      "max.nice" => "float"
      "node_memory_Buffers_bytes" => "integer"
      "node_memory_Cached_bytes" => "integer"
      "avg.node_memory_Cached_bytes" => "float"
      "sum.node_memory_Cached_bytes" => "float"
      "max.node_memory_Cached_bytes" => "float"
      "node_memory_RealMemUsedTotal_bytes" => "integer"
      "node_memory_MemFree_bytes" => "integer"
      "node_memory_MemTotal_bytes" => "integer"
      "node_memory_Slab_bytes" => "integer"
      "avg.node_memory_Slab_bytes" => "float"
      "sum.node_memory_Slab_bytes" => "float"
      "max.node_memory_Slab_bytes" => "float"
      "node_memory_PageTables_bytes" => "integer"
      "node_memory_SwapCached_bytes" => "integer"
      "node_memory_AppUsedTotal_bytes" => "integer"
      "avg.node_memory_AppUsedTotal_bytes" => "float"
      "sum.node_memory_AppUsedTotal_bytes" => "float"
      "max.node_memory_AppUsedTotal_bytes" => "float"
      "node_network_receive_bytes_total" => "float"
      "avg.node_network_receive_bytes_total" => "float"
      "sum.node_network_receive_bytes_total" => "float"
      "max.node_network_receive_bytes_total" => "float"
      "node_network_receive_drop_total" => "float"
      "avg.node_network_receive_drop_total" => "float"
      "sum.node_network_receive_drop_total" => "float"
      "max.node_network_receive_drop_total" => "float"
      "node_network_receive_errs_total" => "float"
      "avg.node_network_receive_errs_total" => "float"
      "sum.node_network_receive_errs_total" => "float"
      "max.node_network_receive_errs_total" => "float"
      "node_network_receive_packets_total" => "float"
      "avg.node_network_receive_packets_total" => "float"
      "sum.node_network_receive_packets_total" => "float"
      "max.node_network_receive_packets_total" => "float"
      "node_network_transmit_bytes_total" => "float"
      "avg.node_network_transmit_bytes_total" => "float"
      "sum.node_network_transmit_bytes_total" => "float"
      "max.node_network_transmit_bytes_total" => "float"
      "node_network_transmit_drop_total" => "float"
      "avg.node_network_transmit_drop_total" => "float"
      "sum.node_network_transmit_drop_total" => "float"
      "max.node_network_transmit_drop_total" => "float"
      "node_network_transmit_errs_total" => "float"
      "avg.node_network_transmit_errs_total" => "float"
      "sum.node_network_transmit_errs_total" => "float"
      "max.node_network_transmit_errs_total" => "float"
      "node_network_transmit_packets_total" => "float"
      "avg.node_network_transmit_packets_total" => "float"
      "sum.node_network_transmit_packets_total" => "float"
      "max.node_network_transmit_packets_total" => "float"
      "node_disk_io_time_seconds_total" => "float"
      "avg.node_disk_io_time_seconds_total" => "float"
      "sum.node_disk_io_time_seconds_total" => "float"
      "max.node_disk_io_time_seconds_total" => "float"
      "node_disk_read_bytes_total" => "float"
      "avg.node_disk_read_bytes_total" => "float"
      "sum.node_disk_read_bytes_total" => "float"
      "max.node_disk_read_bytes_total" => "float"
      "node_disk_read_time_seconds_total" => "float"
      "avg.node_disk_read_time_seconds_total" => "float"
      "sum.node_disk_read_time_seconds_total" => "float"
      "max.node_disk_read_time_seconds_total" => "float"
      "node_disk_write_time_seconds_total" => "float"
      "avg.node_disk_write_time_seconds_total" => "float"
      "sum.node_disk_write_time_seconds_total" => "float"
      "max.node_disk_write_time_seconds_total" => "float"
      "node_disk_written_bytes_total" => "float"
      "avg.node_disk_written_bytes_total" => "float"
      "sum.node_disk_written_bytes_total" => "float"
      "max.node_disk_written_bytes_total" => "float"
      "node_disk_reads_completed_total" => "float"
      "avg.node_disk_reads_completed_total" => "float"
      "sum.node_disk_reads_completed_total" => "float"
      "max.node_disk_reads_completed_total" => "float"
      "node_disk_writes_completed_total" => "float"
      "avg.node_disk_writes_completed_total" => "float"
      "sum.node_disk_writes_completed_total" => "float"
      "max.node_disk_writes_completed_total" => "float"
      "node_disk_io_time_weighted_seconds_total" => "float"
      "avg.node_disk_io_time_weighted_seconds_total" => "float"
      "sum.node_disk_io_time_weighted_seconds_total" => "float"
      "max.node_disk_io_time_weighted_seconds_total" => "float"
      "node_filesystem_size_bytes" => "integer"
      "avg.node_filesystem_size_bytes" => "float"
      "sum.node_filesystem_size_bytes" => "float"
      "max.node_filesystem_size_bytes" => "float"
      "node_filesystem_avail_bytes" => "integer"
      "avg.node_filesystem_avail_bytes" => "float"
      "sum.node_filesystem_avail_bytes" => "float"
      "max.node_filesystem_avail_bytes" => "float"
      "node_filesystem_used_bytes" => "integer"
      "avg.node_filesystem_used_bytes" => "float"
      "sum.node_filesystem_used_bytes" => "float"
      "max.node_filesystem_used_bytes" => "float"
      "AtMinIsrPartitionCount" => "integer"
      "LeaderCount" => "integer"
      "PartitionCount" => "integer"
      "UnderMinIsrPartitionCount" => "integer"
      "ReplicationBytesInPerSec" => "float"
      "ReplicationBytesOutPerSec" => "float"
      "BytesOutPerSec" => "float"
      "BytesInPerSec" => "float"
      "MessagesInPerSec" => "float"
      "BytesRejectedPerSec" => "float"
      "ReplicationFactor" => "integer"
      "TopicPartitionNumber" => "integer"
      "NumLogSegments" => "integer"
      "Size" => "integer"
      "Size_rate" => "float"
      "LogEndOffset" => "integer"
      "LogEndOffset_rate" => "float"
      "SizeChange" => "integer"
      "OffsetChange" => "integer"
      "SizeChangeLeader" => "integer"
      "OffsetChangeLeader" => "integer"
      "kube_node_status_capacity_cpu_cores" => "integer"
      "kube_node_status_capacity_pods" => "integer"
      "kube_node_status_capacity_memory_bytes" => "integer"
      "kube_node_status_allocatable_cpu_cores" => "integer"
      "kube_node_status_allocatable_pods" => "integer"
      "kube_node_status_allocatable_memory_bytes" => "integer"
      "data_disks" => "integer"
      "duration" => "integer"
      "avg.container_fs_io_time_seconds_total" => "float"
      "avg.container_fs_read_seconds_total" => "float"
      "avg.container_fs_reads_bytes_total" => "float"
      "avg.container_fs_write_seconds_total" => "float"
      "avg.container_fs_writes_bytes_total" => "float"
      "max.container_fs_io_time_seconds_total" => "float"
      "max.container_fs_read_seconds_total" => "float"
      "max.container_fs_reads_bytes_total" => "float"
      "max.container_fs_write_seconds_total" => "float"
      "max.container_fs_writes_bytes_total" => "float"
      "avg.container_network_receive_bytes_total" => "float"
      "avg.container_network_receive_errors_total" => "float"
      "avg.container_network_receive_packets_dropped_total" => "float"
      "avg.container_network_receive_packets_total" => "float"
      "avg.container_network_transmit_bytes_total" => "float"
      "avg.container_network_transmit_errors_total" => "float"
      "avg.container_network_transmit_packets_dropped_total" => "float"
      "avg.container_network_transmit_packets_total" => "float"
      "max.container_network_receive_bytes_total" => "float"
      "max.container_network_receive_errors_total" => "float"
      "max.container_network_receive_packets_dropped_total" => "float"
      "max.container_network_receive_packets_total" => "float"
      "max.container_network_transmit_bytes_total" => "float"
      "max.container_network_transmit_errors_total" => "float"
      "max.container_network_transmit_packets_dropped_total" => "float"
      "max.container_network_transmit_packets_total" => "float"
      "max_memory_usage" => "integer"
      "min_memory_usage" => "integer"
      "max_memory_working_set" => "integer"
      "min_memory_working_set" => "integer"
      "cpu_overcommit_sec" => "float"
      "max_cpu_usage" => "float"
      "min_cpu_usage" => "float"
      "max_cpu_usage_per_limit" => "float"
      "max_cpu_usage_per_request" => "float"
      "max_memory_usage_per_limit" => "float"
      "max_memory_usage_per_request" => "float"
      "max_memory_workingset_per_limit" => "float"
      "max_memory_workingset_per_request" => "float"
      "csm_latency_ms_count" => "integer"
      "csm_received_event_count" => "integer"
      "csm_sent_event_count" => "integer"
      "csm_event_drop_count" => "integer"
      "csm_event_unused_count" => "integer"
      "csm_received_bytes" => "integer"
      "csm_sent_bytes" => "integer"
      "csm_processed_event_count" => "integer"
      "csm_received_event_count_rate" => "float"
      "csm_received_bytes_rate" => "float"
      "csm_sent_event_count_rate" => "float"
      "csm_sent_bytes_rate" => "float"
      "csm_processed_event_count_rate" => "float"
      "csm_event_unused_count_rate" => "float"
      "csm_event_drop_count_rate" => "float"
      "oss_correlator_cloud_latency" => "integer"
      "oss_correlator_processed_event_rate" => "integer"
      "oss_correlator_received_event_rate" => "integer"
      "oss_correlator_dropped_events_total" => "integer"
      "oss_correlator_unused_events_total" => "integer"
      "oss_correlator_processed_events_total" => "integer"
      "oss_correlator_received_bytes_total" => "integer"
      "oss_correlator_received_events_total" => "integer"
      "oss_correlator_sent_bytes_total" => "integer"
      "oss_correlator_sent_events_total" => "integer"
      "oss_correlator_dropped_events_total_rate" => "float"
      "oss_correlator_unused_events_total_rate" => "float"
      "oss_correlator_received_bytes_total_rate" => "float"
      "oss_correlator_sent_bytes_total_rate" => "float"
      "oss_correlator_sent_events_total_rate" => "float"
      "vertica_byte_count" => "integer"
      "vertica_row_count" => "integer"
      "refdata_byte_count" => "integer"
      "refdata_row_count" => "integer"
      "start_ts" => "integer"
      "end_ts" => "integer"
      "traffic_length_sec" => "integer"
      "jenkins_build_number" => "integer"
      "install_eea" => "boolean"
      "load_ref_data" => "boolean"
      "traffic_length" => "integer"
      "traffic_device_speed" => "integer"
      "oam_device_speed" => "integer"
      "traffic_max_rx_throughput" => "float"
      "traffic_max_tx_throughput" => "float"
      "traffic_max_rx_usage" => "float"
      "traffic_max_tx_usage" => "float"
      "start_traffic_cus" => "boolean"
      "start_traffic_dataset" => "boolean"
      "start_traffic" => "boolean"
      "install_sep" => "boolean"
      "replay_speed" => "float"
      "eea_eric_eea_analytical_processing_database_TCP_raw_data_size_bytes" => "integer"
      "eea_eric_eea_analytical_processing_database_TCP_compressed_data_size_bytes" => "integer"
      "eea_eric_eea_analytical_processing_database_TCP_requests_count" => "integer"
      "eea_eric_eea_analytical_processing_database_TCP_requests_errors_count" => "integer"
      "duration_ms_LOAD" => "float"
      "duration_ms_QUERY" => "float"
      "duration_ms_SET" => "float"
      "duration_ms_TRANSACTION" => "float"
      "duration_ms_UTILITY" => "float"
      "kafka_connect_sink_task_sink_record_read_rate" => "float"
      "kafka_connect_sink_task_sink_record_read_total" => "integer"
      "kafka_connect_sink_task_sink_record_send_rate" => "float"
      "kafka_connect_sink_task_sink_record_send_total" => "integer"
      "error_log_count" => "integer"
      "critical_log_count" => "integer"
      "doc_count" => "integer"
      }
  }

  date {
    match => [ "ts", "UNIX" ]
    target => "Timestamp"

  }
  mutate {
    remove_field => "@timestamp"
    remove_field => "@version"
    remove_field => "message"
    remove_field => "path"
    remove_field => "host"
    remove_field => "ts"
 }
}

output {
  elasticsearch {
      hosts => ["https://seliics00309.ete.ka.sw.ericsson.se:9200", "https://seliics00310.ete.ka.sw.ericsson.se:9200", "https://seliics00311.ete.ka.sw.ericsson.se:9200"]
      user => "logstash_writer"
      password => "ELASTICSEARCH_PASSWORD"
      index => "${index}"
      ssl => true
      ssl_certificate_verification => false
      cacert => "/etc/logstash/certs/ca/ca.crt"
  }
}
